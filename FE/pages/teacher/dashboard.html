<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£ng ƒëi·ªÅu khi·ªÉn | Gi√°o vi√™n</title>
    <link rel="stylesheet" href="/assets/css/main.css">

    <style>
        body {
            margin: 0;
            font-family: "Segoe UI", Arial, sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }



        main {
            /* padding: 100px 30px 30px; */
            max-width: 1200px;
            margin: 0 auto;
            margin-top: 90px;
            /* background-color: blanchedalmond; */
        }

        .welcome-box {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #fff;
            padding: 20px;
            text-align: center;
            border-radius: 12px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .stat-card h3 {
            font-size: 28px;
            margin: 0;
            color: #2563eb;
            font-weight: 700;
        }

        .card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }

        .list-container {
            margin-top: 15px;
        }

        .item-row {
            padding: 12px 15px;
            border-radius: 10px;
            background: #f1f5f9;
            margin-bottom: 10px;
            font-size: 16px;
        }
    </style>
</head>

<body>
    <!-- HEADER -->
    <header class="topbar">
        <div class="logo">
            <img src="/assets/img/icons/logowebhs.png" alt="logo"
                style="height:40px;width:auto;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.08);margin-right:10px;">
            <span style="font-size:20px;font-weight:700;letter-spacing:1px;color:#fff;">MinhThu</span>
        </div>
        <nav class="menu">
            <a href="/pages/teacher/dashboard.html" class="menu-link active">T·ªïng quan</a>
            <a href="/pages/teacher/teaching-list.html" class="menu-link">Ph√¢n c√¥ng gi·∫£ng d·∫°y</a>
            <a href="/pages/teacher/class-students.html" class="menu-link">Danh s√°ch h·ªçc sinh</a>
            <a href="/pages/teacher/grades/list.html" class="menu-link">Qu·∫£n l√Ω ƒëi·ªÉm</a>
            <a href="/pages/teacher/attendance.html" class="menu-link">ƒêi·ªÉm danh</a>
            <a href="/pages/teacher/subject-statistics.html" class="menu-link">Th·ªëng k√™ m√¥n h·ªçc</a>
            <a href="/pages/teacher/reports/class-statistics.html" class="menu-link">Th·ªëng k√™ l·ªõp</a>

        </nav>

        <div class="user-section">
            <a href="/pages/profile/view-profile.html" style="margin-left:15px; color: #fff;text-decoration: none;">
                <span id="greetingUser">Xin ch√†o, <strong>Admin</strong></span>
            </a> <button class="logout-btn" onclick="logout()">ƒêƒÉng xu·∫•t</button>
        </div>
    </header>

    <!-- MAIN -->
    <main>

        <!-- Greeting Box -->
        <section id="welcome-box" class="welcome-box">
            <h2>üëã Xin ch√†o, <span id="teacherName">Gi√°o vi√™n</span></h2>
            <p id="teacherSpecialization">Chuy√™n m√¥n: ...</p>
        </section>

        <!-- Quick Stats -->
        <section class="stats-grid">
            <div class="stat-card">
                <h3 id="totalClasses">0</h3>
                <p>L·ªõp ƒëang gi·∫£ng d·∫°y</p>
            </div>

            <div class="stat-card">
                <h3 id="totalStudents">0</h3>
                <p>T·ªïng s·ªë h·ªçc sinh</p>
            </div>

            <div class="stat-card">
                <h3 id="avgScore">0.0</h3>
                <p>ƒêi·ªÉm trung b√¨nh</p>
            </div>

            <div class="stat-card">
                <h3 id="passRate">0%</h3>
                <p>T·ªâ l·ªá qua m√¥n</p>
            </div>
        </section>

        <!-- Class List -->
        <section class="card">
            <h2>L·ªõp ƒëang ph·ª• tr√°ch</h2>
            <div id="classList" class="list-container"></div>
        </section>

        <!-- Subject List -->
        <section class="card">
            <h2>M√¥n gi·∫£ng d·∫°y</h2>
            <div id="subjectList" class="list-container"></div>
        </section>

    </main>



    <script src="/assets/js/main.js"></script>
    <script src="/assets/js/auth.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", loadTeacherDashboard);

        async function loadTeacherDashboard() {
            try {
                const token = localStorage.getItem("token");

                const data = await fetch("http://localhost:5000/api/teacher/dashboard", {
                    headers: { "Authorization": "Bearer " + token }
                }).then(r => r.json());

                // G√°n d·ªØ li·ªáu gi√°o vi√™n
                document.getElementById("teacherName").innerText = data.teacher.full_name;
                document.getElementById("teacherSpecialization").innerText =
                    "Chuy√™n m√¥n: " + (data.teacher.specialization ?? "‚Äî");

                // Th·ªëng k√™
                document.getElementById("totalClasses").innerText = data.total_classes;
                document.getElementById("totalStudents").innerText = data.total_students;
                document.getElementById("avgScore").innerText = data.quickStats.avg_score.toFixed(1);
                document.getElementById("passRate").innerText = data.quickStats.pass_rate.toFixed(0) + "%";

                // Danh s√°ch l·ªõp
                renderClassList(data.classes);

                // Danh s√°ch m√¥n
                renderSubjectList(data.subjects);

            } catch (err) {
                console.error("Dashboard error:", err);
            }
        }

        // Render class list
        function renderClassList(classes) {
            const box = document.getElementById("classList");
            box.innerHTML = "";

            if (!classes.length) {
                box.innerHTML = "<p>Ch∆∞a ƒë∆∞·ª£c ph√¢n c√¥ng l·ªõp n√†o.</p>";
                return;
            }

            classes.forEach(c => {
                box.innerHTML += `
            <div class="item-row">
                <strong>${c.class_name}</strong> ‚Äî M√£ l·ªõp: ${c.class_code}
            </div>
        `;
            });
        }

        // Render subject list
        function renderSubjectList(subjects) {
            const box = document.getElementById("subjectList");
            box.innerHTML = "";

            if (!subjects.length) {
                box.innerHTML = "<p>Ch∆∞a ƒë∆∞·ª£c ph√¢n c√¥ng m√¥n d·∫°y.</p>";
                return;
            }

            subjects.forEach(s => {
                box.innerHTML += `
            <div class="item-row">
                üìò ${s.subject_name}
            </div>
        `;
            });
        }
    </script>

</body>

</html>